<app-modal
  (onClose)="close()"
  [isOpen]="isOpen"
  [title]="'Transfer Card to Another Profile'">
  @if (card()) {
    <form (ngSubmit)="onSubmit()" class="space-y-4">
      <div class="bg-slate-50 p-4 rounded-lg border border-slate-200">
        <p class="text-xs text-slate-500 mb-1">Transferring Card:</p>
        <div class="flex items-center gap-3">
          <div
            [style.backgroundColor]="card()!.color || '#334155'"
            class="w-10 h-7 rounded-md shadow-sm">
          </div>
          <div>
            <p class="font-semibold text-slate-800">{{ card()!.cardName }}</p>
            <p class="text-xs text-slate-500">{{ card()!.bankName }}</p>
          </div>
        </div>
      </div>

      <div>
        <label class="block text-xs font-medium text-slate-700 mb-2">
          Select Target Profile
        </label>
        @if (availableProfiles().length === 0) {
          <p class="text-sm text-slate-500 bg-yellow-50 border border-yellow-200 rounded-lg p-3">
            No other profiles available. Create a new profile first.
          </p>
        } @else {
          <div class="space-y-2">
            @for (profile of availableProfiles(); track profile.id) {
              <label
                [style.borderColor]="selectedProfileId === profile.id ? '#3b82f6' : '#e2e8f0'"
                class="flex items-center gap-3 p-3 border-2 rounded-lg cursor-pointer hover:bg-slate-50 transition-all">
                <input
                  [(ngModel)]="selectedProfileId"
                  [value]="profile.id"
                  class="text-blue-600 focus:ring-blue-500"
                  name="targetProfile"
                  type="radio"
                />
                <span class="font-medium text-slate-800">{{ profile.name }}</span>
              </label>
            }
          </div>
        }
      </div>

      @if (availableProfiles().length > 0) {
        <div class="bg-amber-50 border border-amber-200 rounded-lg p-3">
          <p class="text-xs text-amber-800">
            <strong>Note:</strong> This will move the card, all its statements, and installments to the selected
            profile.
          </p>
        </div>

        <button
          [disabled]="!selectedProfileId"
          class="w-full bg-blue-600 text-white py-2.5 rounded-lg text-sm font-medium hover:bg-blue-700 disabled:bg-slate-300 disabled:cursor-not-allowed transition-colors"
          type="submit">
          Transfer Card
        </button>
      }
    </form>
  }
</app-modal>
